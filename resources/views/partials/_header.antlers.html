
{{ banner = { partial:if_exists src="banners/{ slug }" } }}

<script>
// Menu toggle
function isiOS() {
    return (
        ['iPad Simulator', 'iPhone Simulator', 'iPod Simulator', 'iPad', 'iPhone', 'iPod'].includes(navigator.platform) ||
        (navigator.userAgent.includes('Mac') && 'ontouchend' in document)
    );
}

function menu() {
    return {
        open: false,
        disabled: true,
        init() {
            this.disabled = false;
        },
        toggleMenu() {
            const content = document.querySelector('.frontend');
            this.disabled = true;
            this.open = !this.open;
            if (this.open === true) {
                content.style.position = 'fixed';
                content.style.top = `-${window.pageYOffset}px`;
                // Fixes bug in Safari iOS 15.2 where screen height is not fully filled due to empty space address bar on bottom
                if(isiOS() === true) document.documentElement.style.height = window.innerHeight + 'px';
            } else {
                content.style.removeProperty('position');
                content.style.removeProperty('top');
                window.scrollTo(0, window.pageYOffset);
                if(isiOS() === true) document.documentElement.style.removeProperty('height');
            }
            this.disabled = false;
        },
    };
}
</script>

<header class="fixed w-screen z-[999] {{ banner ? 'xl:bg-primary-accent': 'xl:bg-white' }}">

    {{# Desktop navigation #}}
    <div class="container flex-col items-center justify-center hidden p-10 pb-4 mx-auto xl:flex">
        <nav class="hidden w-full h-20 space-x-8 align-middle animated xl:flex 2xl:space-x-10" x-cloak>
            {{ partial:navigation show_home_logo="true" active_class="text-primary-accent" class="" :style="banner ?= 'contrast'" }}
        </nav>
    </div>

    {{# Mobile navigation #}}
    {{ nav_logo = style == 'contrast' ? '/assets/img/logo-alt.svg': '/assets/img/logo.svg' }}
    <div class="relative xl:hidden js-alpine-init {{ banner ? 'bg-primary-accent': 'bg-white' }} pb-6" x-data="menu()" x-init="init()" x-cloak role="navigation">
        <div class="flex flex-row items-start justify-between w-full px-6 pt-10 pb-0 mx-auto">
            <a href="/" class="flex justify-start w-full"><img class="max-w-full max-h-full" src="{{ banner ? '/assets/img/logo-alt.svg': '/assets/img/logo.svg' }}" alt="Home"></a>
            {{# Toggle button #}}
            <div class="absolute top-0 right-0 z-10 flex items-center justify-end m-4">
                <button type="button" @click="toggleMenu()" disabled x-bind:disabled="disabled" class="inline-flex items-center justify-center w-12 h-12 transition duration-150 ease-in-out rounded-md svg-fill text-grey-500 hover:text-grey-500 hover:bg-grey-100 focus:outline-none focus:bg-grey-100 focus:text-grey-500">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="#090910">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>
            </div>
        </div>

        {{# Mobile menu container with transitions #}}
        <div class="fixed inset-x-0 top-0 z-50 w-screen h-screen overflow-scroll transition origin-top-right transform"
            x-show="open" @click.outside="open = false"
            x-transition:enter="duration-200 ease-out" x-transition:enter-start="opacity-0"
            x-transition:enter-end="opacity-100" x-transition:leave="duration-100 ease-in"
            x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
            <div class="w-full overflow-scroll">
                <div class="absolute top-0 left-0 flex flex-col w-full min-h-full bg-primary-contrast">
                    {{# Menu items wrapper #}}
                    <div class="absolute top-0 right-0 z-10">
                        <button type="button" @click="toggleMenu()"
                            disabled x-bind:disabled="disabled"
                            class="relative p-2 px-4 m-4 text-white uppercase transition duration-150 ease-in-out bg-primary-accent svg-fill focus:outline-none font-heading text-10">
                            X
                        </button>
                    </div>
                    {{ partial:navigation_mobile show_home_logo="true" active_class="text-primary-accent" class="" }}
                </div>
            </div>
        </div>
    </div>
</header>

{{# Optional banner #}}
{{ banner }}